import sys
import socket

def main():
    help = """client --ip [target_ip] --port [target_port]
    --ipv6
    --udp
    --h
    """
    ip_protocol = socket.AF_INET
    network_protocol = socket.SOCK_STREAM
    ip = "localhost"
    port = ""
    for i in range(len(sys.argv)):
        match sys.argv[i]:
            case "--ipv6":
                ip_protocol = socket.AF_INET6
            case "--udp":
                network_protocol = socket.SOCK_DGRAM
            case "-u":
                network_protocol = socket.SOCK_DGRAM
            case "--ip":
                ip = sys.argv[i+1]
            case "--port":
                port = int(sys.argv[i+1])
            case "-h":
                print(help)
            case "--help":
                print(help)
    if port == "":
        print("chose one port")
        exit(0)
    client = socket.socket(ip_protocol, network_protocol)
    if network_protocol == socket.SOCK_STREAM:
        with client:
            client.connect((ip,port))
#            client.send(input("insert data: ").encode())
            client.send((b"GET / HTTP/1.1\r\nHost: google.com\r\n\r\n"))
            response = client.recv(4096)
            print(response.decode())
    elif network_protocol == socket.SOCK_DGRAM:
        with client:
            client.sendto(b"AAABBBCCC", (ip,port))
            data, address = client.recvfrom(4096)
            print(data.decode())
            print(address)

if __name__ == "__main__": main();
